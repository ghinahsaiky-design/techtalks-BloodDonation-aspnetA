@model BloodDonation.Models.DonorRequest
@{
    Layout = "_HospitalLayout";
    ViewData["Title"] = "Create Blood Request";
}

<main class="flex-1 overflow-y-auto p-8">
    <div class="max-w-4xl mx-auto">
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg">
                <p class="text-green-800 dark:text-green-200">@TempData["SuccessMessage"]</p>
            </div>
        }
        
        @if (TempData["ErrorMessage"] != null)
        {
            <div class="mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg">
                <p class="text-red-800 dark:text-red-200 whitespace-pre-line">@TempData["ErrorMessage"]</p>
            </div>
        }
        
        <div class="bg-white dark:bg-[#1a1a1a] rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm">
            <div class="p-8 border-b border-gray-100 dark:border-gray-800">
                <h2 class="text-2xl font-bold text-[#181112] dark:text-white">Create Blood Request</h2>
                <p class="text-gray-600 dark:text-gray-400 mt-1">Fill in the required information to create a new blood donation request</p>
            </div>
            
            <form asp-action="CreateRequest" method="post" class="p-8">
                @Html.AntiForgeryToken()
                
                <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-1">
                            <label asp-for="PatientName" class="text-sm font-medium text-gray-700 dark:text-gray-300">Patient Name *</label>
                            <input asp-for="PatientName" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5" placeholder="Enter patient name" type="text"/>
                            <span asp-validation-for="PatientName" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="ContactNumber" class="text-sm font-medium text-gray-700 dark:text-gray-300">Contact Number *</label>
                            <input asp-for="ContactNumber" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5" placeholder="+961 XX XXX XXX" type="tel"/>
                            <span asp-validation-for="ContactNumber" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="RequesterEmail" class="text-sm font-medium text-gray-700 dark:text-gray-300">Requester Email *</label>
                            <input asp-for="RequesterEmail" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5" placeholder="requester@example.com" type="email"/>
                            <p class="text-xs text-gray-500 dark:text-gray-400">Email where donor information will be sent when they confirm</p>
                            <span asp-validation-for="RequesterEmail" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="BloodTypeId" class="text-sm font-medium text-gray-700 dark:text-gray-300">Blood Type *</label>
                            <select asp-for="BloodTypeId" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5">
                                <option value="">Select blood type...</option>
                                @foreach (var bt in ViewBag.BloodTypes as List<BloodDonation.Models.BloodTypes> ?? new List<BloodDonation.Models.BloodTypes>())
                                {
                                    <option value="@bt.BloodTypeId">@bt.Type</option>
                                }
                            </select>
                            <span asp-validation-for="BloodTypeId" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="LocationId" class="text-sm font-medium text-gray-700 dark:text-gray-300">Location *</label>
                            <select asp-for="LocationId" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5">
                                <option value="">Select location...</option>
                                @foreach (var loc in ViewBag.Locations as List<BloodDonation.Models.Locations> ?? new List<BloodDonation.Models.Locations>())
                                {
                                    <option value="@loc.LocationId">@loc.Districts</option>
                                }
                            </select>
                            <span asp-validation-for="LocationId" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="UrgencyLevel" class="text-sm font-medium text-gray-700 dark:text-gray-300">Urgency Level *</label>
                            <select asp-for="UrgencyLevel" required class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5">
                                <option value="">Select urgency...</option>
                                <option value="Critical">Critical</option>
                                <option value="High">High</option>
                                <option value="Normal">Normal</option>
                                <option value="Low">Low</option>
                            </select>
                            <span asp-validation-for="UrgencyLevel" class="text-red-600 text-xs"></span>
                        </div>
                        
                        <div class="space-y-1">
                            <label asp-for="HospitalName" class="text-sm font-medium text-gray-700 dark:text-gray-300">Hospital Name</label>
                            <input asp-for="HospitalName" class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5" placeholder="Hospital name (optional)" type="text"/>
                            <span asp-validation-for="HospitalName" class="text-red-600 text-xs"></span>
                        </div>
                    </div>
                    
                    <div class="space-y-1">
                        <label asp-for="AdditionalNotes" class="text-sm font-medium text-gray-700 dark:text-gray-300">Additional Notes</label>
                        <textarea asp-for="AdditionalNotes" rows="3" class="w-full rounded-lg border-gray-300 dark:border-white/20 dark:bg-white/5 shadow-sm focus:border-primary focus:ring-primary sm:text-sm p-2.5" placeholder="Any additional information..."></textarea>
                        <span asp-validation-for="AdditionalNotes" class="text-red-600 text-xs"></span>
                    </div>
                    
                    <div class="mt-6 flex justify-end gap-3 border-t border-gray-100 dark:border-white/10 pt-4">
                        <a asp-action="Dashboard" class="rounded-lg border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 dark:bg-white/5 dark:text-gray-200 dark:border-white/10">Cancel</a>
                        <button type="submit" class="rounded-lg border border-transparent bg-primary px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2">Create Request</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</main>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
